%!TEX root = ../main.tex
\titleformat{\section}{\normalfont\large\bfseries}{Exercise \thesection\ --- }{1pt}{}
\chapter{Integration}

\section{Cantor set}
In this exercise we investigate a few properties of the Cantor set and Cantor function.
Calling $C_0$ the compact \([0, 1]\) we trisect it and remove the middle open part and define $C_1$ as \([0, 1/3] \cup [2/3, 1]\).
Recursively repeating the process we construct an infinite sequence \(C_0\supset C_1\supset\cdots\supset C_i\supset\cdots\).
We define the \emph{Cantor set} as the intersection of all the nested $C_i$, \(C=\bigcap_{i=0}^\infty C_i\).
\begin{enumerate}
	\item Prove that $C$ is compact.
    \begin{proof}
     By Assignment 1.1(2), the intersection of a collection (finite or infinite) of closed subsets of a metric space is closed.
     By definition of Cantor set, it is an intersection of closed intervals, and thus is closed.
     It is also bounded, since it has lower bound 0 and upper bound 1.
     By Heine-Borel theorem (\ref{Heine-Borel}), every closed bounded subset of $\R$ is compact.
     Hence, the Cantor set is compact.
    \end{proof}
    \item Show that for any two elements \(x<y\in C\), \(\exists z\notin C\) such that \(x<z<y\).
    \begin{proof}
    We can write the Cantor set as
    \[ [0,1]\backslash \bigcup_{n=1}^\infty \bigcup_{k=0}^{3^{n-1}-1}\left(\frac{3k+1}{3^n},\frac{3k+2}{3^n} \right) \]
    Since \(y>x\), we can find $n$ such that 
    \[ m=\left\lfloor \log_{3}{\frac{2}{y-x}} \right\rfloor+1 \]
    Then we have
    \[ \frac{1}{3^m}<\frac{2}{3^m}<y-x \]
    or equivalently,
    \[ 3^m x< 3^m x+1 < 3^m x +2 < 3^m y \]
    We select \(j=\lfloor 3^{m-1} x\rfloor\), then, we have an interval such that
    \[ x<\frac{3j+1}{3^m}<\frac{3j+2}{3^m}<y \]
    Hence, we can always find an interval $Z$ with
    \[ Z=\left(\frac{3j+1}{3^m}, \frac{3j+2}{3^m} \right), \quad Z\cap C=\varnothing \]
    and \(\forall z\in Z, x<z<y, z\notin C\).
    \end{proof}
    \item We estimate how ``large'' the set $C$ is with respect to $\lambda$, the Lebesgue measure.
    \begin{enumerate}[(a)]
    	\item What is the Lebesgue measure of a countable set? 
        \begin{proof}[Answer]
        0
        \end{proof}
        \item Show that for \(n\in\N,\lambda(C_n)=\left(\frac{2}{3}\right)^n\) , and conclude that $C$ has Lebesgue measure 0.
        \begin{proof}
        We can prove by recursive definition.
        By removing the middle part of each interval, we have removed \(\frac{1}{3}\) of the original length, so
        \[ \lambda(C_{n+1})=\frac{2}{3}\lambda(C_n) \]
        Since \(\lambda(C_0)=1\), we have proved \(n\in\N,\lambda(C_n)=\left(\frac{2}{3}\right)^n\).
        By $\sigma$-additivity and Fubini's theorem, we can also interchange the order of limit and summation,
        \[ \lambda(C)=\lambda\left(\lim_{n\to\infty}C_n \right)=\lim_{n\to\infty}\lambda(C_n)=\lim_{n\to\infty}\left(\frac{2}{3}\right)^n=0  \]
        \end{proof}
    \end{enumerate}
    \item We estimate how ``large'' the set $C$ is with respect to cardinality.
    \begin{enumerate}[(a)]
    	\item Show that $C$ is not empty.
        \begin{proof}
        We can find some trivial elements in the Cantor set.
        \[ \left\{0,1,\frac{1}{3},\frac{2}{3} \right\}\subset C \]
        So $C$ is not empty.
        \end{proof}
        \item We write any \(x\in[0,1]\) using the ternary expansion
        \[ x=\sum_{i=1}^\infty \frac{a_i}{3^i}, \quad \textrm{with }a_i\in\left\{0,1,2\right\} \]
        Describe the form of the $x$ belonging to \(C_i, i\in\N\).
        \begin{proof}[Answer]
        \( \forall i\in\N, a_i\neq 1 \)
        \end{proof}
        \item Using Cantor diagonal argument show that Cantor set is uncountable.
        \begin{proof}
		We prove that the Cantor set $C$ has more elements than $\N$.
		Suppose we can construct a bijective map from $\N$ to $C$, then
		\begin{align*}
		n_1 &\to (0.a_{11}a_{12}a_{13}a_{14}\cdots)_3\\
		n_2 &\to (0.a_{21}a_{22}a_{23}a_{24}\cdots)_3\\
		n_3 &\to (0.a_{31}a_{32}a_{33}a_{34}\cdots)_3\\
		&\vdots
		\end{align*}
		where \(a_{ij}\in\{0,2\}\).
		Then we can always find an element from $C$ that is not mapped to.
		Take \(b_1\neq a_{11},b_2\neq a_{22},\cdots,b_i\neq a_{ii},\cdots\), \(0.b_1 b_2 \cdots b_i\cdots\in C\) differs from all the elements in the range of the mapping, so the mapping is not surjective.
		This contradicts to the bijection assumption.
		Thus the bijection does not exist, and $C$ has more elements than $\N$, which implies it is uncountable.
	\end{proof}
    \end{enumerate}
    \item Confront the results from questions 3 and 4.
    \begin{proof}[Answer]
    Although the Cantor set has Lebesgue measure 0, its cardinality is larger than $\aleph_0$.
    This is a very anti-intuition result.
    \end{proof}
\end{enumerate}
We now define the Cantor function following the construction process of the Cantor set.
Let $f_1$ be 1/2 over the ``removed interval'' \((1/3,2/3)\) and linear on $C_1$.
Then define $f_2$ to be $1/4$ and $3/4$ on the two removed intervals, to coincide with $f_1$ in $1/3$ and $2/3$, while being linear on the remaining four intervals.
The process is carried on as the Cantor set is built, defining the Cantor function $f_C$.
\begin{enumerate}
	\setcounter{enumi}{5}
    \item Show that the \((f_n)_{n\in\N}\) define a sequence of monotonically increasing continuous functions.
    \begin{proof}
    By definition, the Cantor function \(f_n(x)\) is constant on \([0,1]\backslash C_n\), where $C_n$ is recursively defined.
    Constant functions are trivially monotone and continuous.
    And \(f_n(x)\) is linear on \(C_n\), while linear functions are also continuous.
    And by definition, they have the same value at the conjunctions, which is also continuous.
    \end{proof}
    \item Show that \((f_n)_{n\in\N}\) converges uniformly to \(f_C:[0,1]\to[0,1]\).
    \begin{proof}
    We apply the analytic expression of \(f_{n+1}\) by \(f_n\):
	\[ f_{n+1}(x)=\begin{cases} \frac{1}{2}f_n(3x) & x\in\left[0,\frac{1}{3} \right] \\ \frac{1}{2} & x\in\left(\frac{1}{3},\frac{2}{3} \right) \\ \frac{1}{2}+\frac{1}{2}f_n(3x-2) & x\in\left[\frac{2}{3},1 \right] \end{cases} \]
    By definition, we find
    \[ \max_{x\in[0,1]}|f_{n+1}(x)-f_n(x)|\leq \frac{1}{2}\max_{x\in[0,1]}|f_{n}(x)-f_{n-1}(x)|,\quad \forall n\geq1 \]
    where \(f_0(x)=x\) on \([0,1]\) as an extended definition. This gives
    \[ \max_{x\in[0,1]}|f(x)-f_n(x)|\leq 2^{-n+1}\max_{x\in[0,1]}|f_{1}(x)-f_{0}(x)| \]
    Both \(f_0\) and \(f_1\) are bounded, so we get the uniform convergence of $f_n$ to $f_C$.
    \end{proof}
    \item Prove that the Cantor function is
    \begin{enumerate}[(a)]
    	\item Uniformly continuous;
        \begin{proof}
        We prove by definition.
        Let \(\varepsilon>0\) be given.
        Select \(n=\lfloor-\log_2\varepsilon\rfloor+1\), and take \(\delta=1/3^n\).
        \[ \forall x,y\in[0,1] \textrm{ with } |x-y|<\delta=\frac{1}{3^n} \]
        then the base-3 expansion of $x$ and $y$ agree for at least the first $n$ terms, which implies
        \[|f_C(x)-f_C(y)|\leq \sum_{j=n+1}^\infty \frac{1}{2^j}=\frac{1}{2^n}<\varepsilon \]
        This gives the uniform continuity of $f_C$ on \([0,1]\).
        \end{proof}
        \item Monotonically increasing (non-decreasing);
        \begin{proof}
        We can prove by the explicit form of the Cantor function
	\[ f_C(x)=f_C\left(\sum_{i=1}^\infty \frac{a_i}{3^i} \right) = \sum_{i=1}^{N_x} \frac{b_n}{2^n}  \]
        where $N_x$ denotes the smallest $i$ such that \(a_{i}=1\) if it exists or \(N_x=\infty\) if there is no such \(a_{i}\), and
	\[ b_n=\begin{cases} a_n/2 & n<N_x \\ 1 & n=N_x \end{cases} \]
	which is the binary expansion of a number in \([0,1]\).
	This is a monotonely increaseing transformation from \(a_n\) to \(b_n\) for \(n<N_x\), and monotonely non-decreasing for \(n=N_x\).
	Thus, if \(x<y\), then their tenary expansions must differ at some point $N$ and at that point \(a_{Nx}<a_{Ny}\).
        The monotocity is preserved by the mapping \(a_n\to b_n\), and is also preserved by binary expansion.
	Thus, the combination, Cantor function, is monotonely non-decreasing.
	\end{proof}
        \item Differentiable almost everywhere, with \(f'(x)=0\);
        \begin{proof}
        By definition, \(f_C(x)\) is constant when \(x\in [0,1]\backslash C\), and the constant function has \(f'_C(x)=0\).
        Since \([0,1]\backslash C\) has Lebesgue measure 1, it is almost everywhere differentiable.
        \end{proof}
    \end{enumerate}
    \item Prove that $f_C$ is not absolutely continuous.
    \begin{proof}
    By selecting \(x_{n_k}\) as the left endpoints of \(C_n\) and \(y_{n_k}\) as the right endpoints, we are able to construct an example to break absolute continuity.
%     \[ x_{n_k}=\frac{3k+1}{3^n}, \quad y_{n_k}=\frac{3k+2}{3^n}, \quad k=0,1,\cdots,3^{n-1}-1 \]
    We have already proved the length of $C_n$ is \(\left(\frac{2}{3}\right)^n\), so we can set \(n=\lfloor\log_{2/3}\delta\rfloor+1 \) such that
    \[ \sum_{k=1}^{2^{n}}|y_{n_k}-x_{n_k}|<\delta \]
    But we can select \(\varepsilon=0.5\), and
    \[ \sum_{k=1}^{2^{n}}|f_C(y_{n_k})-f_C(x_{n_k})|=1>\varepsilon \]
    Thus $f_C$ is not absolutely continuous.
    \end{proof}
\end{enumerate}
\paragraph{Note:} the Cantor function is one of the most simple function to be uniformly continuous but not absolutely continuous.

\section{Taylor's theorem}
Reasoning by induction and applying the fundamental theorem of calculus, prove the following theorems.
\begin{theorem}[Taylor's theorem]
    Given a function $f$ such that \(f^{(n)}\) is absolutely continuous on the compact \([a,x] \subset \R\),
    \[ f(x)=\sum_{k=0}^n\frac{f^{(k)}(a)}{k!}(x-a)^k+\frac{1}{n!}\int_{a}^{x} f^{(n+1)}(t)(x-t)^n \ud t \]
\end{theorem}
\begin{proof}
We prove by induction and integration by parts.
When, \(n=1\), this is the fundamental theorem of calculus.
\[ f(x)=f(a)+\int_a^x f'(t)\ud t \]
Assume this is true for $n$, then by integration by parts,
\begin{align*}
f(x)&=\sum_{k=0}^n\frac{f^{(k)}(a)}{k!}(x-a)^k+\frac{1}{n!}\int_{a}^{x} f^{(n+1)}(t)(x-t)^n \ud t\\
	&=\sum_{k=0}^n\frac{f^{(k)}(a)}{k!}(x-a)^k-\frac{1}{n!}\int_{a}^{x} f^{(n+1)}(t)(x-t)^n \ud (x-t)\\
    &=\sum_{k=0}^n\frac{f^{(k)}(a)}{k!}(x-a)^k-\frac{1}{n!(n+1)}\int_{a}^{x} f^{(n+1)}(t) \ud (x-t)^{n+1}\\
    &=\sum_{k=0}^n\frac{f^{(k)}(a)}{k!}(x-a)^k-\frac{1}{(n+1)!}\left[ \left. f^{(n+1)}(t)(x-t)^{n+1}\right|_{a}^{x} - \int_{a}^{x} (x-t)^{n+1} \ud f^{(n+1)}(t) \right]\\
    &=\sum_{k=0}^n\frac{f^{(k)}(a)}{k!}(x-a)^k+ \frac{f^{(n+1)}(a)(x-a)^{n+1}}{(n+1)!}  + \frac{1}{(n+1)!} \int_{a}^{x} f^{(n+2)}(t) (x-t)^{n+1} \ud t\\
    &=\sum_{k=0}^{n+1}\frac{f^{(k)}(a)}{k!}(x-a)^k+\frac{1}{(n+1)!}\int_{a}^{x} f^{(n+2)}(t)(x-t)^{n+1} \ud t
\end{align*}
which proves the theorem is also true for $n+1$.
By principles of mathematical induction, we have proved the theorem for all \(n\in\N\).
\end{proof}
\begin{theorem}[Taylor's theorem with the remainder in the Lagrange form]
Calling \(P_n(x)\) the polynomial part of \(f(x)\) in Taylor's theorem, show the existence of \(c\in[a,x]\) such that
\[ f(x)-P_n(x)=\frac{f^{n+1}(c)}{(n+1)!}(x-a)^{n+1} \]
\end{theorem}
\begin{proof}
For simplicity, we define
\[ F(x)=f(x)-P_n(x)=\frac{f^{n+1}(c)}{(n+1)!}(x-a)^{n+1} \]
It is easy to observe
\[ F(a)=F'(a)=\cdots=F^{(n)}(a)=0 \]
So it is reasonable to compare $F$ with this function
\[ G(x)=(x-a)^{n+1} \]
which also has
\[ G(a)=G'(a)=\cdots=G^{(n)}(a)=0 \]
Applying Cauchy's Mean Value Theorem \ref{cauchymean} $n+1$ times, \(\exists c_1,c_2,\cdots,c_{n+1}\in[a,x]\) such that
\begin{align*}
	\frac{F(x)}{G(x)}&=\frac{F(x)-F(a)}{G(x)-G(a)}=\frac{F'(c_1)}{G'(c_1)}\\
    &=\frac{F'(c_1)-F'(a)}{G'(c_1)-G'(a)}=\frac{F''(c_2)}{G''(c_2)}\\
    &=\cdots=\frac{F^{(k)}(c_k)-F^{(k)}(a)}{G^{(k)}(c_1)-G^{(k)}(a)}\\
    &=\frac{F^{(n+1)}(c_{n+1})}{G^{(n+1)}(c_{n+1})}
\end{align*}
which means
\[ F(x)= \frac{F^{(n+1)}(c_{n+1})}{G^{(n+1)}(c_{n+1})}G(x) \]
Now we observe that 
\begin{align*}
F^{(n+1)}(c_{n+1})&=f^{(n+1)}(c_{n+1})\\
G^{(n+1)}(c_{n+1})&=(n+1)!
\end{align*}
This gives
\[ F(x)=\frac{f^{(n+1)}(c_{n+1})}{(n+1)!}(x-a)^{n+1} \]
Set \(c=c_{n+1}\), we get the desired result.
\end{proof}

\section{Convergence of rationals to irrationals}
\begin{enumerate}
	\item Show that $e$ is irrational.
    \begin{proof}
    We first get the upper bound and lower bound of $e$.
    Since $e$ is defined to be
    \[e:=\sum_{n=0}^\infty \frac{1}{n!} \]
    We apply the telescoping method:
    \begin{align*}
    	e&=\sum_{n=0}^\infty \frac{1}{n!}>\sum_{n=0}^1 \frac{1}{n!}=1+1=2\\
        e&=\sum_{n=0}^\infty \frac{1}{n!}=1+1+\sum_{n=2}^\infty \frac{1}{n!}<1+1+\sum_{n=1}^\infty \frac{1}{2^n}=3
    \end{align*}
    So we get \(2<e<3\).
    Assume $e$ is rational, then we can write it as a fraction $\frac{a}{b}$, where \(a,b\in\N^*\).
    Since $e$ is not an integer, we have \(b\geq2\), and since \(e>1\), we also have \(a>b\).
    We multiply the both sides of the definition of $e$ by $b!$, ans split the sum to two parts
    \[ \frac{a}{b}\cdot b!=\sum_{n=0}^b \frac{b!}{n!}+\sum_{n=b+1}^\infty \frac{b!}{n!} \]
    The left side of the equation is \(a(b-1)!\), which is an integer.
    The first sum is
    \[ \sum_{n=0}^b \frac{b!}{n!}=\sum_{n=0}^b\binom{b}{n}n! \]
    which is also an integer.
    Thus,
    \[ \sum_{n=b+1}^\infty \frac{b!}{n!} \]
    is an integer.
    However,
    \[ \sum_{n=b+1}^\infty \frac{b!}{n!}<\sum_{n=1}^\infty \frac{b!}{b!\cdot b^n}=\frac{1}{b}<1 \]
    there is no such an integer between 0 and 1.
    Thus, the assumption that $e$ is rational will cause contradiction.
    Hence, $e$ is irrational.
    \end{proof}
    \item Show that the sequence \((u_n)_{n\in\N}\) defined by \(u_n=\left(1+\frac{1}{n}\right)^n\) converges to $e$.
    \begin{proof}
    We first prove a lemma.
    \begin{lemma}
    If a sequence \((a_n)_n\in[0,1]\), 
    \[ \prod_{i=1}^{n}(1-a_i)\geq 1-\sum_{i=1}^n a_i \]
    \end{lemma}
    \begin{proof}
    This is easily proved by mathematical induction. 
    When \(n=1\), the claim becomes \(1-a_1\geq1-a_1\), which is trivially true.
    Next, we assume it is true for $n$.
    If \(\sum_{i=1}^{n+1}a_i>1\), then
    \[ \prod_{i=1}^{n}(1-a_i)\geq 0 > 1- \sum_{i=1}^{n+1}a_i \]
    So we assume \(\sum_{i=1}^{n+1}a_i\leq1\).
    Then we automatically have \(\sum_{i=1}^{n}a_i\leq1\), and
    \begin{align*}
    	\prod_{i=1}^{n+1}(1-a_i)&=(1-a_{n+1})\prod_{i=1}^{n}(1-a_i)\\
        &\geq (1-a_{n+1})\left(1-\sum_{i=1}^n a_i \right)\\
        &= 1-\left(a_{n+1}+\sum_{i=1}^{n}a_i \right)+a_{n+1}\sum_{i=1}^n a_i\\
        &\geq 1-\sum_{i=1}^{n+1}a_i
    \end{align*}
    According to the principle of mathematical induction, we have the lemma proved.
    \end{proof}
    Apply binomial theorem, we can expand $u_n$ as the infinite sum
    \[ u_n=\sum_{i=0}^n \binom{n}{k} \frac{1}{n^k}=\sum_{k=0}^{n}\frac{1}{k!}\cdot\frac{n!}{(n-k)!n^k} \]
    when \(k\geq1\),
    \[ \frac{n!}{(n-k)!n^k}=\prod_{i=0}^{k-1}\left(1-\frac{i}{n}\right) \]
    Apply the lemma, we get the lower bound and the upper bound of the product,
    \[ 1-\sum_{i=0}^{k-1}\frac{i}{n}\leq\prod_{i=0}^{k-1}\left(1-\frac{i}{n}\right)\leq1 \]
    And the lower bound can be simplified to
    \[ 1-\sum_{i=0}^{k-1}\frac{i}{n}=1-\frac{k(k-1)}{2n} \]
    Plug into $u_n$,
    \[ \sum_{k=0}^n \frac{1}{k!}\left(1-\frac{k(k-1)}{2n}\right)\leq u_n\leq\sum_{k=0}^{n}\frac{1}{k!} \]
    and the lower bound can be expanded to
    \[ \sum_{k=0}^n \frac{1}{k!}\left(1-\frac{k(k-1)}{2n}\right)= \sum_{k=0}^{n}\frac{1}{k!}-\frac{1}{2n}\left(1+1+\sum_{k=2}^n \frac{1}{(k-2)!}\right) \]
    while its limit when \(n\to\infty\) is
    \[ \lim_{n\to\infty}\left[\sum_{k=0}^{n}\frac{1}{k!}-\frac{1}{2n}\left(1+1+\sum_{k=2}^n \frac{1}{(k-2)!}\right)\right]=\lim_{n\to\infty}\sum_{k=0}^n\frac{1}{k!}-\lim_{n\to\infty}\frac{e+2}{2n}=e \]
    And the upper bound also has the limit $e$.
    According to the squeeze theorem, if a sequence is bounded by two sequences with the same limit, then the sequence also converges to that limit.
    Thus we conclude that 
    \[ \lim_{n\to\infty}u_n=e \]
    \end{proof}
\end{enumerate}