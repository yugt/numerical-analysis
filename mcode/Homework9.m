%%%%%% Exercise 1
% dy=@(t,y) 1+y^2;
% 
format long
% for i=1:9
%     temp=euler(dy,0,3,0,i);
%     disp((temp(i+1,2)))
% end

%%%%%% Exercise 3
% dy=@(t,y) (2+0.01*t^2)*y;
% temp=euler(dy,0,15,4,15);
% 
% Euler=temp(:,2);
% 
% 
% temp=backwardeuler(0,15,4,15);
% BEuler=temp(:,2);
% 
% 
% 
% temp=taylor2nd(dy,@(t,y)0.02*t*y,@(t,y)2+0.01*t^2,0,15,4,15);
% Taylor2nd=temp(:,2);
% 
% 
% temp=heun(dy,0,15,4,15);
% Heun=temp(:,2);
% 
% 
% [x,AB2]=ab2 ( dy, [0, 15], 4, 15 );
% 
% 
% temp=rk2(dy,0,15,4,15);
% RK2=temp(:,2);
% 
% 
% temp=rk4(dy,0,15,4,15);
% RK4=temp(:,2);
% 
% 
% Exact=4*exp(x.^3/300+2*x);
% 
% set(gca(), 'LooseInset', get(gca(), 'TightInset'));
% 
% semilogy(x,Exact,x,Euler,x,BEuler,x,Taylor2nd,x,Heun,x,AB2,x,RK2,x,RK4)
% legend('Exact','Euler','Backward Euler','Taylor 2nd order','Heun','Adams-Bashforth','Runge-Kutta 2nd order','Runge-Kutta 4th order','Location','NorthWest')
% axis([0 15 1 1e20]);

%%%%%% Exercise 3
% f=@(t,y) [y(2); y(3); -y(3)/t+2*y(2)/t^2-2*y(1)/t^3+8-2/t^3  ];
% M=10;
% h=1/M;
% T=zeros(1,M+1);
% Y=zeros(3,M+1);
% T=1:h:2;
% Y(:,1)=[2;8;6];
% for j=1:M
%    k1=h*f(T(j),Y(:,j));
%    k2=h*f(T(j)+h/2,Y(:,j)+k1/2);
%    k3=h*f(T(j)+h/2,Y(:,j)+k2/2);
%    k4=h*f(T(j)+h,Y(:,j)+k3);
%    Y(:,j+1)=Y(:,j)+(k1+2*k2+2*k3+k4)/6;
% end
% set(gca(), 'LooseInset', get(gca(), 'TightInset'));
% Exact=-1./T+2*T+T.^2+T.^3-1;
% plot(T,Exact-Y(1,:))

% legend('Exact','Runge-Kutta 4th order','Location','NorthWest')

f=@(t,y) 1/((t-0.3)^2+0.01)+1/((t-0.9)^2+0.04)-6;
temp=rk4(f,0,1,0,100);


0	0
0.0100000000000000	0.0549797183105351
0.0200000000000000	0.116772142716691
0.0300000000000000	0.186002345192911
0.0400000000000000	0.263371275737248
0.0500000000000000	0.349666853374583
0.0600000000000000	0.445776853617648
0.0700000000000000	0.552703875636214
0.0800000000000000	0.671582698308538
0.0900000000000000	0.803700348235838
0.100000000000000	0.950519192359251
0.110000000000000	1.11370331267906
0.120000000000000	1.29514828785827
0.130000000000000	1.49701424409328
0.140000000000000	1.72176156464447
0.150000000000000	1.97218784121106
0.160000000000000	2.25146333094302
0.170000000000000	2.56316009838788
0.180000000000000	2.91126684538179
0.190000000000000	3.30017679707888
0.200000000000000	3.73462963744755
0.210000000000000	4.21958048693869
0.220000000000000	4.75996043170018
0.230000000000000	5.36028739093567
0.240000000000000	6.02408986292971
0.250000000000000	6.75313026068542
0.260000000000000	7.54647199331241
0.270000000000000	8.39953077470110
0.280000000000000	9.30336660635922
0.290000000000000	10.2445480798474
0.300000000000000	11.2058657471219
0.310000000000000	12.1679335644239
0.320000000000000	13.1113672894575
0.330000000000000	14.0189628873569
0.340000000000000	14.8772980009925
0.350000000000000	15.6774453655196
0.360000000000000	16.4148371730700
0.370000000000000	17.0885571362653
0.380000000000000	17.7003918964561
0.390000000000000	18.2538982241368
0.400000000000000	18.7536264937370
0.410000000000000	19.2045445896888
0.420000000000000	19.6116489555563
0.430000000000000	19.9797253276686
0.440000000000000	20.3132179408244
0.450000000000000	20.6161717164591
0.460000000000000	20.8922204269981
0.470000000000000	21.1446018307244
0.480000000000000	21.3761871462757
0.490000000000000	21.5895168705658
0.500000000000000	21.7868381199935
0.510000000000000	21.9701407589734
0.520000000000000	22.1411908987493
0.530000000000000	22.3015611550299
0.540000000000000	22.4526575251156
0.550000000000000	22.5957430064590
0.560000000000000	22.7319582098336
0.570000000000000	22.8623392735193
0.580000000000000	22.9878333929016
0.590000000000000	23.1093122628766
0.600000000000000	23.2275837006235
0.610000000000000	23.3434016807775
0.620000000000000	23.4574749777596
0.630000000000000	23.5704745730023
0.640000000000000	23.6830399489455
0.650000000000000	23.7957843571402
0.660000000000000	23.9092991145042
0.670000000000000	24.0241569494784
0.680000000000000	24.1409143883992
0.690000000000000	24.2601131419148
0.700000000000000	24.3822804222095
0.710000000000000	24.5079280952279
0.720000000000000	24.6375505498597
0.730000000000000	24.7716211510049
0.740000000000000	24.9105871396464
0.750000000000000	25.0548628558733
0.760000000000000	25.2048211968019
0.770000000000000	25.3607832879707
0.780000000000000	25.5230064513208
0.790000000000000	25.6916707009346
0.800000000000000	25.8668641907294
0.810000000000000	26.0485682704886
0.820000000000000	26.2366430614910
0.830000000000000	26.4308147107216
0.840000000000000	26.6306656794536
0.850000000000000	26.8356295135001
0.860000000000000	27.0449914723756
0.870000000000000	27.2578961187824
0.880000000000000	27.4733624733048
0.890000000000000	27.6903066514255
0.900000000000000	27.9075711013574
0.910000000000000	28.1239587748993
0.920000000000000	28.3382699313400
0.930000000000000	28.5493389214809
0.940000000000000	28.7560682985801
0.950000000000000	28.9574579554532
0.960000000000000	29.1526276186000
0.970000000000000	29.3408318159396
0.980000000000000	29.5214672327441
0.990000000000000	29.6940730574678
1	29.8583254149691